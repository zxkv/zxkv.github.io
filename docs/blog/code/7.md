# äºŒè¿›åˆ¶æµæ–‡ä»¶å¯¼å‡º

### ğŸ‰ åœºæ™¯éœ€æ±‚

å¼€å‘åå°ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œéš¾å…ä¼šæ¶‰åŠåˆ°æ–‡ä»¶çš„ä¸Šä¼ å’Œæ–‡ä»¶çš„å¯¼å‡ºã€‚ç°åœ¨å‰ç«¯ä¸Šä¼ æ–‡ä»¶ä¸»è¦é‡‡ç”¨â€œäºŒè¿›åˆ¶æ–‡ä»¶æµâ€çš„å½¢å¼æ¥ä¸Šä¼ æ–‡ä»¶ã€‚ä¸Šä¼ ä¸»è¦æ–¹å¼æœ‰ä»¥ä¸‹æ–¹å¼ï¼š

-   å‰ç«¯ç›´æ¥ä¼ é€’äº‘å­˜å‚¨æˆ–è€…è‡ªèº«æœåŠ¡å™¨ï¼Œæ¥è·å–ä¸Šä¼ æ–‡ä»¶çš„äº‘ç«¯ç»å¯¹åœ°å€ï¼›
-   å‰ç«¯å€ŸåŠ©åå°æ¥å®ç°æ–‡ä»¶çš„å­˜å‚¨å’Œä¸Šä¼ ï¼Œç„¶åç»åå°å¤„ç†æ¥è¿”å›æ–‡ä»¶å­˜å‚¨è·¯å¾„ã€‚

ä¸Šä¼ æ–‡ä»¶ä¹Ÿæ ¹æ®æ–‡ä»¶æ ¼å¼è¿›è¡Œåˆ†ç±»å­˜å‚¨æˆ–è€…åœ¨ä¸Šä¼ å‰è¿›è¡Œæ–‡ä»¶çš„å¤§å°å’Œæ ¼å¼çš„æ ¡éªŒå¤„ç†ï¼Œä»¥é˜²ä¹±ä¼ é€’åƒåœ¾æ–‡ä»¶æ¶ˆè€—äº‘ç›˜å­˜å‚¨ç©ºé—´å’Œæµªè´¹æµé‡ç­‰ã€‚

### ğŸŒ æ–‡ä»¶æ ¼å¼

åå°ç®¡ç†ç³»ç»Ÿä¸€èˆ¬ç”¨ä½œå¤„ç†æ–‡æ¡£æ•°æ®ç›¸å…³ï¼Œå¯¼å‡ºçš„æ•°æ®å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

-   ç”¨äºæ•°æ®ç»Ÿè®¡çš„**Excel**æ–‡ä»¶ï¼Œä¸»æµæ–‡ä»¶æ ¼å¼ä¸ºï¼š**.xls** å’Œ **.xlsx**ï¼›
-   ç”¨äºæ–‡æ¡£é€šçŸ¥çš„**Word**æ–‡ä»¶ï¼Œä¸»æµæ–‡ä»¶æ ¼å¼ä¸ºï¼š**.doc**å’Œ **.docx**ï¼›
-   ç”¨äºå¹»ç¯ç‰‡çš„**PowerPoint**æ–‡ä»¶ï¼Œä¸»æµæ–‡ä»¶æ ¼å¼ä¸ºï¼š**.ppt** å’Œ **.pptx**ï¼›

### ğŸŠ æ–‡ä»¶å¯¼å‡º

1. ä»åå° API è·å–äºŒè¿›åˆ¶æµæ–‡ä»¶åœ°å€ï¼Œè¿›è¡Œå¤„ç†ï¼›
2. é…ç½®å‰ç«¯è¯·æ±‚æ–¹å¼ï¼Œä»¥ **blob** çš„æ–¹å¼è¯·æ±‚è·å–æ–‡ä»¶æµï¼›
3. é€šè¿‡ [**URL.createObjectURL()**](https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL) é™æ€æ–¹æ³•åˆ›å»ºä¸€ä¸ª**DOMString**ï¼›

    - [URL.createObjectURL() - Web API æ¥å£å‚è€ƒ | MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL)

4. åŠ¨æ€åˆ›å»ºç”¨äºæ–‡ä»¶ä¸‹è½½çš„ **a** æ ‡ç­¾ï¼Œå¹¶èµ‹å€¼ **herf** å’Œ **download** å±æ€§ï¼Œå¹¶è§¦å‘è¯¥æ ‡ç­¾çš„ç‚¹å‡»äº‹ä»¶ï¼›
5. é€šè¿‡ [**URL.revokeObjectURL()**](https://developer.mozilla.org/zh-CN/docs/Web/API/URL/revokeObjectURL) é™æ€æ–¹æ³•æ¥é‡Šæ”¾ä¹‹å‰é€šè¿‡ **URL.createObjectURL()** åˆ›å»ºçš„ **URL** å¯¹è±¡ã€‚

    - [URL.revokeObjectURL() - Web API æ¥å£å‚è€ƒ | MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/URL/revokeObjectURL)

### ğŸ ä»£ç ç¤ºä¾‹

```javascript title="ä»£ç ç¤ºä¾‹"
/* æ—¶é—´æˆ³ */
const timeStamp = () => {
	const date = new Date();

	let yyyy = date.getFullYear(),
		MM = date.getMonth() + 1,
		dd = date.getDate(),
		hh = date.getHours(),
		mm = date.getMinutes(),
		ss = date.getSeconds();
	// è¡¥0
	MM = MM < 10 ? "0" + MM : MM;
	dd = dd < 10 ? "0" + dd : dd;
	hh = hh < 10 ? "0" + hh : hh;
	mm = mm < 10 ? "0" + mm : mm;
	ss = ss < 10 ? "0" + ss : ss;

	let timeStr = `${yyyy}${MM}${dd}${hh}${mm}${ss}`;
	return timeStr;
};

/* å¯¼å‡ºæ•°æ® */
const exportData = () => {
	// æ‰€éœ€å‚æ•°
	let params = {};

	axios
		.get("API", { responseType: "blob", params })
		.then(res => {
			setTimeout(() => {
				// è·å–æ–‡ä»¶æµï¼Œç”Ÿæˆ URL å¯¹è±¡
				let url = window.URL.createObjectURL(res.data);
				// åˆ›å»ºç”¨äºä¸‹è½½çš„ a æ ‡ç­¾
				let link = document.createElement("a");
				// éšè—åŠ¨æ€åˆ›å»ºçš„ a æ ‡ç­¾
				link.style.display = "none";
				// è®¾ç½® herf å±æ€§å¹¶èµ‹å€¼ç”Ÿæˆçš„ url æ–‡ä»¶åœ°å€
				link.href = url;
				// ç”Ÿæˆæ—¶é—´æˆ³
				let timeStr = timeStamp();
				/**
				 * é‡å‘½åæ–‡ä»¶å
				 * æ ¼å¼å¿…é¡»ä»¥ â€œ.æ–‡ä»¶æ ¼å¼åç¼€åâ€çš„å½¢å¼ç»“å°¾
				 *  */
				let fileName = `${timeStr}.xls`;
				// è®¾ç½®è¢«ä¸‹è½½çš„è¶…é“¾æ¥ç›®æ ‡
				link.setAttribute("download", fileName);
				// è§¦å‘ a æ ‡ç­¾è·³è½¬
				link.click();
				// é‡Šæ”¾ URL å¯¹è±¡
				window.URL.revokeObjectURL(url);
			}, 500);
		})
		.catch(err => {
			console.log("å¯¼å‡ºå¤±è´¥ï¼š", err);
		});
};
```

**ğŸš æ³¨**ï¼šæ–‡ä»¶åç¼€åæ ¹æ®è¦æ±‚è¿›è¡Œå®šä¹‰ã€‚

```javascript title="ä»£ç ç¤ºä¾‹"
// æ–‡ä»¶å‘½åæ ¼å¼

// 5ä½æ•°éšæœºæ•°
let timeStr = parseInt(Math.random(0, 1) * 1e5);

// å½“å‰æ—¶é—´æˆ³
let timeStr = new Date().toLocaleString();

// è·å–headersä¸­çš„æ–‡ä»¶å
let fileName = res.headers["content-disposition"].split(";")[1].split("filename=")[1];
```

**ğŸ» æ³¨**ï¼šä¸Šè¿°â€œ**è·å– headers ä¸­çš„æ–‡ä»¶å**â€ä¸ºåœ¨è¯·æ±‚æ¥å£æ—¶åå°æºå¸¦çš„æ–‡ä»¶åï¼Œè‹¥â€œ**æ— **â€åˆ™éœ€è‡ªå®šä¹‰æ–‡ä»¶åã€‚
